# 중앙처리장치(CPU) 작동 원리

- CPU(Central Processing Unit, 중앙처리장치)

- 컴퓨터의 두뇌 역할을 하며, 프로그램을 실행하고 명령어를 해석하여 연산을 수행하는 가장 중요한 부품 

- CPU는 다양한 연산을 수행하며, 이를 위해 여러 개의 하위 장치들로 구성되어 있다.




### 1. CPU의 주요 구성 요소

- CPU는 크게 연산 장치(ALU), 제어 장치(CU), 레지스터(Register) 로 구성된다.

1) 연산 장치(ALU, Arithmetic and Logic Unit)

- 산술 연산(+, -, *, /)과 논리 연산(AND, OR, NOT 등)을 수행하는 장치.

- 데이터를 레지스터에서 가져와 연산을 수행한 후, 다시 레지스터에 결과를 저장.

- CPU 내부에서 가장 핵심적인 계산을 담당하며, 산술논리연산장치라고도 불린다.


2) 제어 장치(CU, Control Unit)

- 명령어를 순차적으로 실행할 수 있도록 제어하는 장치.

- 프로그램 명령어를 주기억장치(RAM)에서 가져와 해석한 뒤, 실행을 위한 제어 신호를 각 장치에 전달.

- 입출력 장치, 연산 장치, 기억 장치 등의 동작을 조율하여 CPU가 올바르게 동작하도록 한다.


3) 레지스터(Register)

- CPU 내부에 존재하는 초고속 임시 기억 장치.

- CPU가 직접 접근할 수 있기 때문에, 데이터 저장 및 연산 결과를 보관하는 용도로 사용됨.

- CPU 종류에 따라 레지스터 개수와 크기가 다름.

- 레지스터는 용도에 따라 범용 레지스터와 특수목적 레지스터로 나뉜다.




### 2. 레지스터의 종류

- 레지스터는 크게 범용 레지스터(General Purpose Register) 와 특수목적 레지스터(Special Purpose Register) 로 나뉜다.

1) 범용 레지스터

- 연산에 필요한 데이터나 연산 결과를 임시로 저장.

- 특정한 용도로 제한되지 않고 일반적인 데이터 저장에 사용됨.


2) 특수목적 레지스터

- 특정한 역할을 수행하는 레지스터.

- CPU가 올바르게 동작하도록 명령어를 관리하는 기능을 함.


3) 특수목적 레지스터 종류

- MAR (Memory Address Register): 주 기억장치에서 읽기/쓰기 연산을 수행할 주소를 저장

- PC (Program Counter): 다음에 실행할 명령어의 주소를 저장

- IR (Instruction Register): 현재 실행 중인 명령어를 저장

- MBR (Memory Buffer Register): 주기억장치에서 읽어온 데이터 or 저장할 데이터를 임시로 저장

- AC (Accumulator): 연산 결과를 임시 저장




### 3. CPU의 동작 과정

- 전체적인 흐름은 아래와 같다.

- 주기억장치(RAM)가 입력 장치에서 입력받은 데이터 또는 보조기억장치(HDD, SSD)에 저장된 프로그램을 읽어온다.

- CPU가 프로그램을 실행하기 위해 주기억장치에서 명령어와 데이터를 읽어와 처리한 후, 결과를 다시 주기억장치에 저장한다.

- 주기억장치가 연산 결과를 보조기억장치에 저장하거나 출력장치(모니터, 프린터 등)로 전송한다.

- 제어 장치(CU) 는 1~3 과정에서 명령어가 순서대로 실행되도록 각 장치를 제어한다.




### 4. 명령어 세트 (Instruction Set)

1) 명령어 구성

- CPU가 실행할 명령어의 집합을 명령어 세트(Instruction Set)라고 한다.

- 명령어는 다음과 같은 두 요소로 구성된다:
    - 연산 코드 (OpCode): 실행할 연산의 종류 (예: ADD, LOAD, JUMP 등).
    - 피연산자 (Operand): 연산에 필요한 데이터 or 데이터의 저장 위치.


2) 명령어의 기능

- 연산(Arithmetic & Logical Operations): 덧셈, 뺄셈, AND, OR 등의 연산 수행.

- 제어(Control Operations): 프로그램 흐름을 변경하는 명령어 (JUMP, CALL 등).

- 데이터 전달(Data Transfer Operations): 레지스터 간 또는 기억장치와의 데이터 이동 (LOAD, STORE 등).

- 입출력(Input/Output Operations): 키보드 입력, 모니터 출력 등.




### 5. 명령어 사이클 (Instruction Cycle)

- CPU는 프로그램을 실행하기 위해 주기억장치에서 명령어를 하나씩 읽고 해석하여 실행하는 과정을 반복 => 일련의 활동을 명령어 사이클(Instruction Cycle) 이라고 함.

1) 명령어 사이클의 단계

- 인출(Fetch): 주기억장치에서 명령어를 가져오는 과정.

- 해독(Decode): 명령어를 분석하여 수행해야 할 작업을 해석.

- 실행(Execute): 명령어를 실행하여 연산을 수행.

- 간접(Indirect): 일부 명령어의 경우 실행 전 추가적으로 데이터 접근 필요.

- 인터럽트(Interrupt): 특정 이벤트(입출력, 오류 등)가 발생하면 실행을 중단하고 처리를 수행.




### 6. 명령어 처리 과정 (Fetch-Execute Cycle)

1) 명령어 인출 (Fetch)

- 인출 사이클에서 가장 중요한 부분은 PC(프로그램 카운터) 값 증가.

- 명령어 인출을 위한 단계별 동작:
    - T0: MAR <= PC (프로그램 카운터의 값을 메모리 주소 레지스터로 전달)
    - T1: MBR <= M[MAR], PC <= PC + 1 (해당 주소에서 명령어를 읽어오고, PC 증가)
    - T2: IR <= MBR (읽어온 명령어를 명령어 레지스터로 이동)


2) 명령어 실행 (Execute)

- ADD addr (덧셈 연산): 주어진 주소에서 데이터를 읽어와 AC(누산기)에 더함.
    - T0: MAR <= IR(Addr)
    - T1: MBR <= M[MAR]
    - T2: AC <= AC + MBR
    - LOAD addr (데이터 로드)

- 특정 주소에서 데이터를 가져와 AC에 저장.
    - T0: MAR ← IR(Addr)
    - T1: MBR ← M[MAR]
    - T2: AC ← MBR
    - STA addr (데이터 저장)

- AC의 값을 특정 주소에 저장.
    - T0: MAR ← IR(Addr)
    - T1: MBR ← AC
    - T2: M[MAR] ← MBR
    - JUMP addr (분기)

- 실행할 명령어의 위치를 변경.
    - T0: PC ← IR(Addr)




### 7. 결론

- CPU는 연산장치(ALU), 제어장치(CU), 레지스터 로 구성되며, 프로그램을 실행하는 핵심 부품이다.

- CPU는 명령어 사이클(Instruction Cycle) 을 반복하면서 명령어를 인출(Fetch), 해독(Decode), 실행(Execute)한다.

- 명령어 세트(Instruction Set) 에 의해 실행되는 프로그램은 CPU의 구조에 따라 다르게 동작할 수 있다.

- 레지스터 는 명령어 실행을 빠르게 수행할 수 있도록 데이터를 저장하는 중요한 역할을 한다.
